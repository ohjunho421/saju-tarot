# 날짜 인식 기능 추가 완료 📅

## 🎯 기능 개요

AI 해석 시 **현재 날짜, 계절, 절기, 음력 정보**를 자동으로 인식하여 더욱 정확하고 시기적절한 해석을 제공합니다.

## ✨ 새로 추가된 기능

### 1. **현재 시점 정보 자동 수집**
- 양력 날짜
- 음력 날짜 (윤달 표시 포함)
- 요일
- 계절 (봄/여름/가을/겨울)
- 24절기 정보
- 별자리

### 2. **계절별 오행 기운 분석**
- 봄: 목(木) 기운 왕성
- 여름: 화(火) 기운 왕성
- 가을: 금(金) 기운 왕성
- 겨울: 수(水) 기운 왕성

### 3. **AI 프롬프트 강화**
- 현재 시점 정보를 AI에게 제공
- 계절적 오행 기운 고려
- 절기에 맞는 해석 요청
- 해당 월에 적합한 조언 생성

## 📋 수집되는 정보

### 날짜 컨텍스트
```typescript
{
  solarDate: "2025년 10월 28일",
  lunarDate: "음력 2025년 9월 6일",
  year: 2025,
  month: 10,
  day: 28,
  weekday: "화요일",
  season: "가을",
  jieqi: "상강",  // 24절기
  zodiacSign: "전갈자리"
}
```

### 시기 설명 생성
```
현재는 가을철입니다. 오늘은 화요일이고, 2025년 10월 28일입니다. 
음력으로는 음력 2025년 9월 6일입니다. 24절기상 상강 시기입니다. 
별자리는 전갈자리 구간입니다.
```

## 🔍 AI 해석 개선사항

### Before (날짜 정보 없음)
```
통합 해석: 당신의 사주에서 금 기운이 강하므로...
```

### After (날짜 정보 포함)
```
통합 해석: 현재는 가을철로 금(金) 기운이 왕성한 시기입니다. 
당신의 사주 역시 금 기운이 강하므로, 이 시기는 특히 유리합니다.
24절기상 상강 시기로 기온이 낮아지는 때이니...
```

## 💡 사용 예시

### 예시 1: 봄철 해석
```
현재 시점: 2025년 4월 15일 (봄, 청명 절기)
계절 기운: 목(木) 기운 왕성

AI 해석:
"봄철 목(木) 기운이 왕성한 시기입니다. 당신의 사주에서 목 기운이 
약한 편이므로, 이 시기를 활용하여 새로운 일을 시작하기 좋습니다.
청명 절기는 만물이 생동하는 때로, 창의적인 프로젝트를 추진하세요."
```

### 예시 2: 여름철 해석
```
현재 시점: 2025년 7월 20일 (여름, 대서 절기)
계절 기운: 화(火) 기운 왕성

AI 해석:
"여름철 화(火) 기운이 절정인 대서 시기입니다. 당신의 사주에 
화 기운이 많아 과열될 수 있으니, 차분하게 균형을 유지하세요.
무더운 날씨만큼 열정적인 시기이므로..."
```

### 예시 3: 겨울철 해석
```
현재 시점: 2025년 12월 15일 (겨울, 대설 절기)
계절 기운: 수(水) 기운 왕성

AI 해석:
"겨울철 수(水) 기운이 강한 대설 시기입니다. 당신의 사주에 
수 기운이 부족하므로, 이 시기는 보충의 기회입니다.
내면을 돌아보고 충전하는 시간으로 활용하세요..."
```

## 🛠️ 기술 구현

### 1. DateHelper 유틸리티
```typescript
// 현재 날짜 컨텍스트 생성
const dateContext = DateHelper.getCurrentDateContext();

// 시기 설명 생성
const timingInfo = DateHelper.getTimingDescription(dateContext);

// 계절별 오행 기운
const seasonalElement = DateHelper.getSeasonalElement(dateContext.season);
```

### 2. AI 프롬프트 통합
```typescript
const prompt = `
[현재 시점 정보]
${timingInfo}
계절적 특성: ${seasonalElement}

[사용자 정보]
...

[해석 지침]
1. 통합 해석: 현재 시점(${dateContext.season}, ${dateContext.jieqi})의 
   영향을 반드시 포함하세요
2. 오행 조화 분석: 현재 계절의 오행 기운(${seasonalElement})도 고려하세요
3. 맞춤형 조언: 이번 달(${dateContext.month}월)과 현재 절기에 맞는 
   실천 방법을 제시하세요
`;
```

### 3. lunar-javascript 라이브러리 활용
```typescript
import { Solar, Lunar } from 'lunar-javascript';

const now = new Date();
const solar = Solar.fromDate(now);
const lunar = solar.getLunar();

// 음력 정보
lunar.getYear();
lunar.getMonth();
lunar.getDay();
lunar.isLeap(); // 윤달 여부

// 24절기
lunar.getPrevJieQi()?.getName();
```

## 📊 계절별 특성 정리

### 봄 (3~5월) - 목(木)
- **특성**: 성장, 확장, 새 시작
- **색상**: 청색, 녹색
- **절기**: 입춘, 우수, 경칩, 춘분, 청명, 곡우
- **추천 활동**: 새로운 프로젝트 시작, 학습, 창의적 작업

### 여름 (6~8월) - 화(火)
- **특성**: 열정, 활동, 번성
- **색상**: 적색
- **절기**: 입하, 소만, 망종, 하지, 소서, 대서
- **추천 활동**: 적극적 행동, 네트워킹, 열정적 추진

### 가을 (9~11월) - 금(金)
- **특성**: 수확, 결실, 정리
- **색상**: 백색, 금색
- **절기**: 입추, 처서, 백로, 추분, 한로, 상강
- **추천 활동**: 결과 정리, 재무 관리, 계획 수립

### 겨울 (12~2월) - 수(水)
- **특성**: 저장, 휴식, 내면
- **색상**: 흑색
- **절기**: 입동, 소설, 대설, 동지, 소한, 대한
- **추천 활동**: 내면 탐구, 공부, 충전, 계획

## 🎴 절기별 타로 해석 가이드

### 입춘~춘분 (봄 초)
- 새로운 시작의 기운
- Wands, Page 카드 강조

### 청명~곡우 (봄 후)
- 성장과 확장
- Ace, 3 번 카드 강조

### 입하~하지 (여름 초)
- 활동과 열정
- Cups, Knights 강조

### 소서~대서 (여름 후)
- 정점과 과열 주의
- 균형 카드(Temperance) 강조

### 입추~추분 (가을 초)
- 수확과 정리
- Pentacles, 9/10 강조

### 한로~상강 (가을 후)
- 마무리와 준비
- Swords, 결단 카드 강조

### 입동~동지 (겨울 초)
- 휴식과 저장
- Major Arcana 강조

### 소한~대한 (겨울 후)
- 극한의 추위, 내면 탐구
- Hermit, Star 강조

## 📱 UI 개선사항

### 타로 리딩 화면
```
✨ 타로 리딩

스프레드를 선택하고 질문을 입력해주세요
📅 2025년 10월 28일 화요일
```

### 결과 화면 (향후)
```
📅 리딩 시점
2025년 10월 28일 화요일
음력 2025년 9월 6일
가을 / 상강 시기
금(金) 기운 왕성
```

## 🔮 실제 해석 차이 비교

### 질문: "이번 프로젝트가 성공할까요?"

#### Before
```
당신의 사주에서 금 기운이 강하므로 논리적이고 
체계적인 접근이 유리합니다.
```

#### After (10월, 가을, 상강)
```
현재 가을철로 금(金) 기운이 왕성한 상강 시기입니다.
당신의 사주 역시 금 기운이 강하므로, 지금은 특히 
논리적 판단과 체계적 추진이 빛을 발하는 시기입니다.

상강은 서리가 내리기 시작하는 때로, 마무리와 정리의 
시기입니다. 프로젝트의 세부사항을 꼼꼼히 점검하고,
연말까지 완성도를 높이는 데 집중하세요.

10월은 수확의 달입니다. 그간의 노력이 결실을 맺을 
조짐이 보이니, 조급해하지 말고 차근차근 마무리하세요.
```

## 📈 예상 효과

### 사용자 경험
- ✅ 더 정확한 타이밍 해석
- ✅ 실천 가능한 시기별 조언
- ✅ 계절감 있는 해석
- ✅ 절기에 맞는 생활 지침

### AI 해석 품질
- ✅ 맥락 있는 분석
- ✅ 구체적인 시기 언급
- ✅ 계절적 오행 고려
- ✅ 더 풍부한 내용

## 🚀 향후 개선 계획

### Phase 1 (완료) ✅
- [x] 현재 날짜 인식
- [x] 계절/절기 정보
- [x] AI 프롬프트 통합

### Phase 2 (향후)
- [ ] 음력 날짜 강조 표시
- [ ] 절기별 운세 가이드
- [ ] 계절별 추천 스프레드

### Phase 3 (고급)
- [ ] 개인별 절기 운세 (사주 기반)
- [ ] 대운/세운 자동 계산
- [ ] 일진/시진 분석

## 💻 코드 변경사항

### Backend
- `utils/date-helper.ts` - 날짜 유틸리티 (신규)
- `types/lunar-javascript.d.ts` - 타입 정의 (신규)
- `services/ai.service.ts` - AI 프롬프트에 날짜 정보 추가

### Frontend
- `components/TarotReading.tsx` - 현재 날짜 표시 추가

## 🧪 테스트 방법

### 1. 계절별 테스트
```javascript
// 시스템 날짜를 변경하여 테스트
// 또는 DateHelper를 Mock하여 테스트
```

### 2. 절기별 테스트
각 절기 시점에 해석 차이 확인

### 3. 음력/양력 변환 테스트
lunar-javascript 라이브러리 정확도 검증

## ⚠️ 주의사항

### 개발자
- lunar-javascript 라이브러리 버전 확인
- 타임존 설정 (한국 시간 기준)
- 서버 시간과 사용자 시간 차이 고려

### 사용자
- 서버 시간 기준으로 날짜 계산됨
- 자정 전후 시간대는 날짜 확인 필요

## 📝 예시 응답

### AI 생성 해석 예시
```
[통합 해석]
현재 10월 말, 가을이 깊어가는 상강 시기입니다. 금(金) 기운이 
왕성한 이때, 당신의 사주에서 금 기운이 강한 점이 매우 유리하게 
작용합니다. 타로에서 뽑힌 펜타클 나이트는 착실하고 체계적인 
추진을 나타내며, 지금의 계절 기운과 완벽하게 조화를 이룹니다.

[오행 조화 분석]
가을철 금(金) 기운과 당신의 강한 금 기운이 만나 시너지를 
만들고 있습니다. 다만 계절과 사주 모두 금 기운이 강하므로, 
목(木) 기운을 보완하는 것이 중요합니다. 타로의 Wands 계열 
카드가 없는 점도 이를 시사합니다.

[맞춤형 조언]
10월 말~11월 초는 연말을 앞두고 정리하는 시기입니다.
- 이달 안에 미뤄둔 일들을 마무리하세요
- 상강 시기답게 차가운 기운을 활용해 냉철한 판단을 내리세요
- 목 기운 보충: 산책, 독서, 새로운 학습 시작
```

---

**날짜 인식으로 더욱 정확하고 시기적절한 타로 해석!** 📅✨

**업데이트 일자**: 2025-10-28  
**버전**: 1.2.0 (AI + 조언 카드 + 날짜 인식)
